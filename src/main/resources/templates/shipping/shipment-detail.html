<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="'Shipment: ' + ${shipment.motherVesselName}">Shipment Detail</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <div>
            <h2>
                <i class="fas fa-ship"></i>
                <span th:text="${shipment.motherVesselName}">Mother Vessel</span>
            </h2>
            <p class="text-muted">
                Consignee:
                <span th:text="${shipment.consignee}">Consignee</span> 路
                Arrival:
                <span th:text="${shipment.arrivalDate}">2025-01-01</span> 路
                Item:
                <span th:text="${shipment.itemType}">Item</span>
            </p>
        </div>
        <div>
            <a th:href="@{/shipping/shipments}" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Back to Shipments
            </a>
            <a th:href="@{'/shipping/shipment/' + ${shipment.id} + '/edit'}" class="btn btn-primary">
                <i class="fas fa-edit"></i> Edit
            </a>
        </div>
    </div>

    <!-- Flash messages -->
    <div th:if="${successMessage}" class="alert alert-success" th:text="${successMessage}"></div>
    <div th:if="${errorMessage}" class="alert alert-danger" th:text="${errorMessage}"></div>

    <!-- High-level stats -->
    <div class="row mb-4">
        <div class="col-md-3">
            <div class="card text-bg-light">
                <div class="card-body">
                    <h6 class="card-title text-muted mb-1">Total Incoming Qty</h6>
                    <h4 class="mb-0" th:text="${shipment.totalIncomingQuantity}">0</h4>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-bg-light">
                <div class="card-body">
                    <h6 class="card-title text-muted mb-1">Total Loaded Qty</h6>
                    <h4 class="mb-0" th:text="${shipment.totalLoadedQuantity}">0</h4>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-bg-light">
                <div class="card-body">
                    <h6 class="card-title text-muted mb-1">Lighters</h6>
                    <h4 class="mb-0" th:text="${shipment.lighterCount}">0</h4>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-bg-light">
                <div class="card-body">
                    <h6 class="card-title text-muted mb-1">Trucks</h6>
                    <h4 class="mb-0" th:text="${shipment.truckCount}">0</h4>
                </div>
            </div>
        </div>
    </div>

    <!-- Lighters / Trucks / Products hierarchy -->
    <div class="accordion" id="lightersAccordion">
        <div th:if="${#lists.isEmpty(shipment.lighterLoadings)}" class="alert alert-info">
            No lighters added yet for this shipment.
        </div>

        <div class="accordion-item" th:each="lighter, lighterStat : ${shipment.lighterLoadings}">
            <h2 class="accordion-header" th:attr="id=${'lighter-heading-' + lighterStat.index}">
                <button class="accordion-button collapsed" type="button"
                        data-bs-toggle="collapse"
                        th:attr="data-bs-target=${'#lighter-body-' + lighterStat.index}"
                        aria-expanded="false"
                        th:attrappend="aria-controls=${'lighter-body-' + lighterStat.index}">
                    <i class="fas fa-anchor me-2"></i>
                    <span th:text="${lighter.lighterName}">Lighter Name</span>
                    <span class="ms-3 badge bg-secondary" th:text="'Loaded: ' + ${lighter.loadedQuantity}">Loaded</span>
                    <span class="ms-2 badge bg-info text-dark"
                          th:text="'Unloaded: ' + ${lighter.totalUnloadedQuantity}">Unloaded</span>
                </button>
            </h2>
            <div th:attr="id=${'lighter-body-' + lighterStat.index}"
                 class="accordion-collapse collapse"
                 th:attrappend="aria-labelledby=${'lighter-heading-' + lighterStat.index}"
                 data-bs-parent="#lightersAccordion">
                <div class="accordion-body">
                    <p class="mb-2 text-muted">
                        Destination:
                        <span th:text="${lighter.destination}">Destination</span> 路
                        Unloading Point:
                        <span th:text="${lighter.unloadingPoint}">Point</span> 路
                        Loading Date:
                        <span th:text="${lighter.loadingDate}">Date</span>
                    </p>

                    <!-- Trucks -->
                    <div class="table-responsive"
                         th:if="${!#lists.isEmpty(lighter.truckUnloadings)}">
                        <table class="table table-sm table-bordered align-middle">
                            <thead class="table-light">
                            <tr>
                                <th>#</th>
                                <th>Conveyance</th>
                                <th>Unloading Date</th>
                                <th>Destination</th>
                                <th>Unloaded Qty</th>
                                <th>Unloading Cost</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr th:each="truck, truckStat : ${lighter.truckUnloadings}">
                                <td th:text="${truckStat.index + 1}">1</td>
                                <td th:text="${truck.conveyanceName}">Truck</td>
                                <td th:text="${truck.unloadingDate}">2025-01-01</td>
                                <td th:text="${truck.destination}">Dest</td>
                                <td th:text="${truck.unloadedQuantity}">0</td>
                                <td th:text="${truck.unloadingCost}">0</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                    <div th:if="${#lists.isEmpty(lighter.truckUnloadings)}"
                         class="alert alert-info mb-0">
                        No trucks recorded for this lighter yet.
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>



